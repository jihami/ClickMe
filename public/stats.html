<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>STATS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang&family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/stats.css">
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-storage.js"></script>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="js/stats.js"></script>
    <script>
        const username = sessionStorage.getItem("name")
    </script>
</head>
<body>
    <div id="popup">
        <button type="button" id="close">
            <a href="#"><img src="img/close.PNG" alt="close"></a>
        </button>

        <div id="popup_contents">
            <div id="badgeExample"></div>
            <label><textarea id="badgeText" maxlength="500" disabled></textarea></label>
            <button type="button" id="submit" onclick="submit(toKen)">전송</button>
            <button type="button" id="cancel">취소</button>
            <div id="goGit" onclick="goGit()">내 git 페이지 가기</div>
            <div id="alert" style="color: red">오류 시 잠시 후 다시 시도해주세요.</div>
        </div>
    </div>

    <div id="head">
        <div id="logo" onclick="location.href='index.html'">
            <img src="img/logo_color.png" alt="logo">
        </div>

        <div id="user">
            <ul id="head_menu">
                <a href="mypage.html">
                    <a href="#"><li id="user_name" class="login" onclick="githubLogin()">Git Hub Login</li></a>
                    <a href="#"><li id="logout" class="logout" onclick="githubLogOut()" style="display:none;">Logout</li></a>
                    <script>
                        const firebaseConfig = {
                            //  firebase sdk
                            apiKey: "AIzaSyAScwaKmiKUyqgxaPBk2VUrydYSHUJF3pY",
                            authDomain: "clickme-ca826.firebaseapp.com",
                            projectId: "clickme-ca826",
                            storageBucket: "clickme-ca826.appspot.com",
                            messagingSenderId: "229716770871",
                            appId: "1:229716770871:web:ba982b7fd732da3dd47fb2",
                            measurementId: "G-KT1SPMPS2N"
                        };

                        firebase.initializeApp(firebaseConfig);

                        const firebaseInstance = firebase;
                        const authService = firebase.auth();
                        const user = firebase.auth().currentUser;

                        const githubLogin = async () => {
                            const provider = new firebaseInstance.auth.GithubAuthProvider();
                            const data = await authService.signInWithPopup(provider);

                            const username = data.additionalUserInfo.username
                            console.log(username)
                            const email = data.user.email
                            console.log(email)
                            const displayName = data.user.displayName
                            console.log(displayName)
                            document.getElementById('user_name').innerHTML = username+"님"

                            // 로그인 완료 시 로그아웃 버튼 보이기
                            $(function(){
                                $('#logout').show();
                            })

                            // 세션에 name를 사용하여 저장
                            sessionStorage.setItem("name", username)
                        }

                        function githubLogOut() {
                            firebase.auth().signOut().then(() => {
                                // Sign-out successful.
                                document.getElementById("user_name").innerHTML = "Git Hub Login"
                            }).catch((error) => {
                                // An error happened.
                                console.log("logoutError")
                            });

                            // 로그아웃 시 버튼 숨기기
                            $(function(){
                                $('#logout').hide();
                            })

                            // 로그아웃 시 세션 삭제
                            sessionStorage.removeItem("name")
                        }

                        // 세션이 있다면 로그인 상태 유지
                        $(function (){
                            if(sessionStorage.length != 0){
                                document.getElementById('user_name').innerHTML = sessionStorage.getItem("name")+"님"

                                $(function(){
                                    $('#logout').show();
                                })
                            }
                        })
                    </script>
                </a>
            </ul>
        </div>
    </div>

    <div id="main">
        <p id="title">STATS</p>

        <table id="contents">
            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=flag-india" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=vue" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=algoia" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=coalt2" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=buefy" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=swift" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=solarized-light" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=gruvbox_light" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=moltack" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=kacho_ga" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=maroongold" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=gruvbox" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=calm" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=cobalt" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=vue-dark" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=nord" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=material-palenight" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=blueberry" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=aura_dark" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=panda" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=noctis_minimus" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=apprentice" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=slateorange" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=onedark" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=city_lights" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=discord_old_blurple" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=darcula" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=bear" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=monokai" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=react" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=ayu-mirage" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=dracula" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=vision-friendly-dark" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=radical" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=merko" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=tokyonight" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=dark" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=midnight-purple" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=nightowl" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=blue-green" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=great-gatsby" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=chartreuse-dark" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=omni" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=gotham" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=yeblu" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=outrun" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=ocean_dark" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=github_dark" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=aura" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=codeSTACKr" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=rose_pine" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=synthwave" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=shades-of-purple" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=jolly" alt="STATS"/>
                </td>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=solarized-dark" alt="STATS"/>
                </td>
            </tr>

            <tr>
                <td>
                    <img class="stat" src="https://github-readme-stats.vercel.app/api?username=anuraghazra&show_icons=true&theme=prussian" alt="STATS"/>
                </td>
            </tr>
        </table>
    </div>
</body>
</html>
